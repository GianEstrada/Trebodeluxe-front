<!DOCTYPE html>
<html>
<head>
    <title>Test Size Systems Fix</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        // Simular el componente con hooks corregidos
        const { useState, useEffect } = React;

        const AdminPage = () => {
            // Estados del componente principal (correcto)
            const [sizeSystemsData, setSizeSystemsData] = useState([]);
            const [sizeSystemsLoading, setSizeSystemsLoading] = useState(false);
            const [sizeSystemSearchQuery, setSizeSystemSearchQuery] = useState('');
            const [showSizeSystemForm, setShowSizeSystemForm] = useState(false);
            const [editingSizeSystem, setEditingSizeSystem] = useState(null);
            const [sizeSystemFormData, setSizeSystemFormData] = useState({
                nombre: '',
                tallas: ['', '', '']
            });

            // Función renderSizeSystems sin hooks (correcto)
            const renderSizeSystems = () => {
                // Funciones que usan el estado del componente principal
                const addSizeInput = () => {
                    setSizeSystemFormData({
                        ...sizeSystemFormData,
                        tallas: [...sizeSystemFormData.tallas, '']
                    });
                };

                const openCreateForm = () => {
                    setSizeSystemFormData({
                        nombre: '',
                        tallas: ['', '', '']
                    });
                    setEditingSizeSystem(null);
                    setShowSizeSystemForm(true);
                };

                return (
                    <div style={{padding: '20px', fontFamily: 'Arial, sans-serif'}}>
                        <h2 style={{color: '#22c55e'}}>✅ Sistema de Tallas - Error #310 Corregido</h2>
                        <p style={{color: '#4ade80'}}>
                            Todos los hooks useState están ahora en el nivel del componente principal.
                        </p>
                        <div style={{marginTop: '20px', padding: '15px', background: '#f0f9ff', border: '1px solid #38bdf8', borderRadius: '8px'}}>
                            <h3>Estado actual:</h3>
                            <p><strong>Búsqueda:</strong> "{sizeSystemSearchQuery}"</p>
                            <p><strong>Cargando:</strong> {sizeSystemsLoading ? 'Sí' : 'No'}</p>
                            <p><strong>Formulario visible:</strong> {showSizeSystemForm ? 'Sí' : 'No'}</p>
                            <p><strong>Editando:</strong> {editingSizeSystem ? 'Sistema existente' : 'Ninguno'}</p>
                            <p><strong>Tallas en formulario:</strong> {sizeSystemFormData.tallas.length}</p>
                        </div>
                        
                        <div style={{marginTop: '20px'}}>
                            <button 
                                onClick={() => setSizeSystemSearchQuery('Nueva búsqueda')}
                                style={{padding: '10px 20px', marginRight: '10px', background: '#3b82f6', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer'}}
                            >
                                Probar búsqueda
                            </button>
                            <button 
                                onClick={openCreateForm}
                                style={{padding: '10px 20px', marginRight: '10px', background: '#22c55e', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer'}}
                            >
                                Abrir formulario
                            </button>
                            <button 
                                onClick={addSizeInput}
                                style={{padding: '10px 20px', background: '#f59e0b', color: 'white', border: 'none', borderRadius: '5px', cursor: 'pointer'}}
                            >
                                Agregar talla
                            </button>
                        </div>

                        {showSizeSystemForm && (
                            <div style={{marginTop: '20px', padding: '15px', background: '#fef3c7', border: '1px solid #f59e0b', borderRadius: '8px'}}>
                                <h3>Formulario de Sistema de Tallas</h3>
                                <input 
                                    type="text"
                                    value={sizeSystemFormData.nombre}
                                    onChange={(e) => setSizeSystemFormData({...sizeSystemFormData, nombre: e.target.value})}
                                    placeholder="Nombre del sistema"
                                    style={{padding: '8px', width: '300px', marginBottom: '10px', border: '1px solid #ccc', borderRadius: '4px'}}
                                />
                                <div>
                                    <h4>Tallas:</h4>
                                    {sizeSystemFormData.tallas.map((talla, index) => (
                                        <div key={index} style={{marginBottom: '5px'}}>
                                            <input 
                                                type="text"
                                                value={talla}
                                                onChange={(e) => {
                                                    const newTallas = [...sizeSystemFormData.tallas];
                                                    newTallas[index] = e.target.value;
                                                    setSizeSystemFormData({...sizeSystemFormData, tallas: newTallas});
                                                }}
                                                placeholder={`Talla ${index + 1}`}
                                                style={{padding: '5px', width: '150px', marginRight: '10px', border: '1px solid #ccc', borderRadius: '4px'}}
                                            />
                                        </div>
                                    ))}
                                </div>
                                <button 
                                    onClick={() => setShowSizeSystemForm(false)}
                                    style={{padding: '8px 16px', background: '#ef4444', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer', marginTop: '10px'}}
                                >
                                    Cerrar
                                </button>
                            </div>
                        )}
                    </div>
                );
            };

            return renderSizeSystems();
        };

        ReactDOM.render(<AdminPage />, document.getElementById('root'));
    </script>
</body>
</html>
