<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test B√∫squeda de Productos - Admin Treboluxe</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1e3a5f, #2d5f3f);
            color: white;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .search-input {
            flex: 1;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(0,0,0,0.3);
            color: white;
            font-size: 14px;
        }
        
        .search-input::placeholder {
            color: rgba(255,255,255,0.5);
        }
        
        button {
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .search-btn {
            background: #22c55e;
            color: white;
        }
        
        .search-btn:hover {
            background: #16a34a;
        }
        
        .add-btn {
            background: #3b82f6;
            color: white;
        }
        
        .add-btn:hover {
            background: #2563eb;
        }
        
        .results-count {
            margin-bottom: 15px;
            color: #d1d5db;
            font-size: 14px;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .product-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 20px;
            transition: transform 0.3s ease;
        }
        
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .product-title {
            font-size: 18px;
            font-weight: bold;
            color: white;
            margin-bottom: 12px;
        }
        
        .variant-section {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .product-image {
            width: 80px;
            height: 80px;
            background: #e5e7eb;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 12px;
            flex-shrink: 0;
            overflow: hidden;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-info {
            flex: 1;
        }
        
        .variant-name {
            font-size: 16px;
            font-weight: 600;
            color: #10b981;
            margin-bottom: 8px;
        }
        
        .product-description {
            color: #d1d5db;
            font-size: 13px;
            line-height: 1.4;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .price-section {
            margin-bottom: 10px;
        }
        
        .current-price {
            font-size: 18px;
            font-weight: bold;
            color: white;
        }
        
        .original-price {
            font-size: 14px;
            color: #9ca3af;
            text-decoration: line-through;
            margin-left: 8px;
        }
        
        .sizes-section {
            margin-bottom: 15px;
        }
        
        .sizes-label {
            color: #9ca3af;
            font-size: 13px;
            margin-bottom: 8px;
        }
        
        .sizes-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .size-tag {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 12px;
        }
        
        .size-available {
            background: #065f46;
            color: white;
        }
        
        .size-unavailable {
            background: #4b5563;
            color: #9ca3af;
        }
        
        .stock-total {
            color: #d1d5db;
            font-size: 13px;
            font-weight: 500;
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
            font-size: 16px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #10b981;
            font-size: 16px;
        }
        
        .highlight {
            background: rgba(34, 197, 94, 0.2);
            padding: 2px 4px;
            border-radius: 4px;
            color: #86efac;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ†Ô∏è Test B√∫squeda de Productos - Admin Treboluxe</h1>
        
        <div class="section">
            <div class="search-bar">
                <input 
                    type="text" 
                    id="searchInput" 
                    class="search-input"
                    placeholder="Buscar productos, variantes, categor√≠as, marcas o descripciones..."
                >
                <button onclick="searchProducts()" class="search-btn">
                    üîç Buscar
                </button>
                <button onclick="alert('Funci√≥n agregar variante')" class="add-btn">
                    + Agregar Variante
                </button>
            </div>
            
            <div id="resultsCount" class="results-count"></div>
            <div id="loadingIndicator" class="loading" style="display: none;">
                ‚è≥ Cargando productos...
            </div>
            <div id="productsContainer" class="products-grid"></div>
        </div>
    </div>

    <script>
        // Datos de ejemplo que simular√≠an venir del backend
        const mockVariants = [
            {
                id_variante: 1,
                nombre_producto: "Polo Cl√°sico Premium",
                nombre_variante: "Azul Marino",
                descripcion_producto: "Polo de algod√≥n 100% con corte cl√°sico y acabados de alta calidad. Perfecto para uso diario o eventos casuales.",
                categoria: "Polos",
                marca: "Treboluxe",
                precio: 34.99,
                precio_original: 49.99,
                imagen_url: null,
                tallas_stock: [
                    { id_talla: 1, nombre_talla: "XS", cantidad: 5 },
                    { id_talla: 2, nombre_talla: "S", cantidad: 12 },
                    { id_talla: 3, nombre_talla: "M", cantidad: 8 },
                    { id_talla: 4, nombre_talla: "L", cantidad: 0 },
                    { id_talla: 5, nombre_talla: "XL", cantidad: 3 }
                ]
            },
            {
                id_variante: 2,
                nombre_producto: "Polo Cl√°sico Premium",
                nombre_variante: "Blanco",
                descripcion_producto: "Polo de algod√≥n 100% con corte cl√°sico y acabados de alta calidad. Perfecto para uso diario o eventos casuales.",
                categoria: "Polos",
                marca: "Treboluxe",
                precio: 34.99,
                precio_original: 49.99,
                imagen_url: "https://images.unsplash.com/photo-1581803118522-7b72a50f7e9f?w=200&h=200&fit=crop",
                tallas_stock: [
                    { id_talla: 1, nombre_talla: "XS", cantidad: 2 },
                    { id_talla: 2, nombre_talla: "S", cantidad: 15 },
                    { id_talla: 3, nombre_talla: "M", cantidad: 20 },
                    { id_talla: 4, nombre_talla: "L", cantidad: 7 },
                    { id_talla: 5, nombre_talla: "XL", cantidad: 1 }
                ]
            },
            {
                id_variante: 3,
                nombre_producto: "Camiseta B√°sica Premium",
                nombre_variante: "Negro",
                descripcion_producto: "Camiseta b√°sica de algod√≥n suave con excelente ca√≠da y durabilidad. Ideal para combinaciones casuales.",
                categoria: "Camisetas",
                marca: "Treboluxe",
                precio: 24.99,
                imagen_url: "https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=200&h=200&fit=crop",
                tallas_stock: [
                    { id_talla: 2, nombre_talla: "S", cantidad: 25 },
                    { id_talla: 3, nombre_talla: "M", cantidad: 30 },
                    { id_talla: 4, nombre_talla: "L", cantidad: 18 },
                    { id_talla: 5, nombre_talla: "XL", cantidad: 12 }
                ]
            },
            {
                id_variante: 4,
                nombre_producto: "Camiseta B√°sica Premium",
                nombre_variante: "Gris Melange",
                descripcion_producto: "Camiseta b√°sica de algod√≥n suave con excelente ca√≠da y durabilidad. Ideal para combinaciones casuales.",
                categoria: "Camisetas",
                marca: "Treboluxe",
                precio: 24.99,
                imagen_url: null,
                tallas_stock: [
                    { id_talla: 1, nombre_talla: "XS", cantidad: 8 },
                    { id_talla: 2, nombre_talla: "S", cantidad: 22 },
                    { id_talla: 3, nombre_talla: "M", cantidad: 0 },
                    { id_talla: 4, nombre_talla: "L", cantidad: 15 },
                    { id_talla: 5, nombre_talla: "XL", cantidad: 6 }
                ]
            },
            {
                id_variante: 5,
                nombre_producto: "Camisa Formal Business",
                nombre_variante: "Azul Cielo",
                descripcion_producto: "Camisa formal de algod√≥n egipcio con corte slim fit. Perfecta para reuniones de negocios y eventos formales.",
                categoria: "Camisas",
                marca: "Executive Line",
                precio: 59.99,
                precio_original: 79.99,
                imagen_url: "https://images.unsplash.com/photo-1586790170083-2f9ceadc732d?w=200&h=200&fit=crop",
                tallas_stock: [
                    { id_talla: 2, nombre_talla: "S", cantidad: 4 },
                    { id_talla: 3, nombre_talla: "M", cantidad: 8 },
                    { id_talla: 4, nombre_talla: "L", cantidad: 12 },
                    { id_talla: 5, nombre_talla: "XL", cantidad: 5 }
                ]
            },
            {
                id_variante: 6,
                nombre_producto: "Sudadera Casual Urban",
                nombre_variante: "Verde Militar",
                descripcion_producto: "Sudadera con capucha de felpa francesa. Dise√±o urbano moderno con excelente comodidad y estilo.",
                categoria: "Sudaderas",
                marca: "Urban Style",
                precio: 45.99,
                imagen_url: "https://images.unsplash.com/photo-1556821840-3a9c6fcc67b0?w=200&h=200&fit=crop",
                tallas_stock: [
                    { id_talla: 3, nombre_talla: "M", cantidad: 14 },
                    { id_talla: 4, nombre_talla: "L", cantidad: 10 },
                    { id_talla: 5, nombre_talla: "XL", cantidad: 8 },
                    { id_talla: 6, nombre_talla: "XXL", cantidad: 3 }
                ]
            }
        ];

        let currentSearch = '';
        let filteredVariants = [...mockVariants];

        // Funci√≥n para resaltar texto en b√∫squedas
        function highlightText(text, search) {
            if (!search) return text;
            const regex = new RegExp(`(${search})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        // Funci√≥n de b√∫squeda
        function searchProducts() {
            const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
            currentSearch = searchTerm;
            
            if (!searchTerm) {
                filteredVariants = [...mockVariants];
            } else {
                filteredVariants = mockVariants.filter(variant => 
                    variant.nombre_producto.toLowerCase().includes(searchTerm) ||
                    variant.nombre_variante.toLowerCase().includes(searchTerm) ||
                    variant.categoria.toLowerCase().includes(searchTerm) ||
                    variant.marca.toLowerCase().includes(searchTerm) ||
                    (variant.descripcion_producto && variant.descripcion_producto.toLowerCase().includes(searchTerm))
                );
            }
            
            renderProducts();
        }

        // Funci√≥n para renderizar productos
        function renderProducts() {
            const container = document.getElementById('productsContainer');
            const resultsCount = document.getElementById('resultsCount');
            
            // Actualizar contador de resultados
            if (currentSearch) {
                resultsCount.innerHTML = `Se encontraron <strong>${filteredVariants.length}</strong> resultados para: "<strong>${currentSearch}</strong>"`;
            } else {
                resultsCount.innerHTML = `Total de variantes: <strong>${filteredVariants.length}</strong>`;
            }
            
            if (filteredVariants.length === 0) {
                container.innerHTML = `
                    <div class="no-results">
                        ${currentSearch ? 
                            'No se encontraron productos o variantes que coincidan con tu b√∫squeda' : 
                            'No se encontraron productos o variantes'
                        }
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredVariants.map(variant => {
                const totalStock = variant.tallas_stock.reduce((total, talla) => total + talla.cantidad, 0);
                
                return `
                    <div class="product-card">
                        <div class="product-title">
                            ${highlightText(variant.nombre_producto, currentSearch)}
                        </div>
                        
                        <div class="variant-section">
                            <div class="product-image">
                                ${variant.imagen_url ? 
                                    `<img src="${variant.imagen_url}" alt="${variant.nombre_variante}">` : 
                                    'Sin imagen'
                                }
                            </div>
                            
                            <div class="product-info">
                                <div class="variant-name">
                                    ${highlightText(variant.nombre_variante, currentSearch)}
                                </div>
                                <div class="product-description">
                                    ${highlightText(variant.descripcion_producto, currentSearch)}
                                </div>
                                <div class="price-section">
                                    <span class="current-price">$${variant.precio}</span>
                                    ${variant.precio_original ? 
                                        `<span class="original-price">$${variant.precio_original}</span>` : 
                                        ''
                                    }
                                </div>
                            </div>
                        </div>
                        
                        <div class="sizes-section">
                            <div class="sizes-label">Tallas y Stock:</div>
                            <div class="sizes-container">
                                ${variant.tallas_stock.map(talla => `
                                    <span class="size-tag ${talla.cantidad > 0 ? 'size-available' : 'size-unavailable'}">
                                        ${talla.nombre_talla}: ${talla.cantidad}
                                    </span>
                                `).join('')}
                                ${variant.tallas_stock.length === 0 ? 
                                    '<span class="size-tag size-unavailable">Sin tallas configuradas</span>' : 
                                    ''
                                }
                            </div>
                        </div>
                        
                        <div class="stock-total">
                            <strong>Total en stock: ${totalStock}</strong>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Event listeners
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchProducts();
            }
        });

        // B√∫squeda en tiempo real (opcional)
        document.getElementById('searchInput').addEventListener('input', function(e) {
            // B√∫squeda en tiempo real con debounce
            clearTimeout(this.searchTimeout);
            this.searchTimeout = setTimeout(() => {
                searchProducts();
            }, 300);
        });

        // Cargar productos iniciales
        document.addEventListener('DOMContentLoaded', function() {
            renderProducts();
        });
    </script>
</body>
</html>
